<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Optimization Baseline - Inventario</title>
    <link rel="stylesheet" href="CSS/INVENTARIO/crearInv.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>

<body>

<header>
    <nav class="menu">
        <div class="logo-container">
            <img th:src="@{IMG/imagen-bob.png}" alt="Logo BOB" class="logo">
            <div class="logo-text-container">
                <h1 class="logo-text">Building Optimization Baseline</h1>
                <p class="logo-subtext">Gesti贸n inteligente de proyectos de construcci贸n</p>
            </div>
        </div>
        <ul class="nav-links">
            <li><a th:href="@{error404.html}">Perfil</a></li>
        </ul>
    </nav>
</header>

<main>
    <div class="menu-dasboard">
        <div class="menu">
            <a class="enlace" th:href="@{/indice}"><i class="bx bxs-user-detail"></i><span>Gestion de Usuarios</span></a>
            <a class="enlace" th:href="@{/inventario}"><i class="bx bx-box"></i><span>Inventario</span></a>
            <a class="enlace" th:href="@{/avances/inicioAvances}"><i class="bx bx-buildings"></i><span>Avances</span></a>
            <a class="enlace" th:href="@{/contratista}"><i class="bx bx-receipt"></i><span>Contratista</span></a>
            <a class="enlace" th:href="@{/presupuestos/inicioPresupuestos}"><i class="bx bx-money-withdraw"></i><span>Presupuesto</span></a>
            <a class="enlace" href="proveedores.html"><i class="bx bx-hard-hat"></i><span>Proveedores</span></a>
            <a class="enlace" href="#reportes"><i class="bx bx-line-chart"></i><span>Reportes</span></a>
            <a class="enlace" href="#configuracion"><i class="bx bx-cog"></i><span>Configuraci贸n</span></a>
        </div>
    </div>

    <div class="dashboard-content">
        <div class="inventory-header">
            <h2><i class='bx bx-box'></i> M贸dulo de Inventario</h2>
        </div>

        <div class="form-container">
            <div class="form-header">
                <h1>Agregar inventario</h1>
                <a th:href="@{/inventario}" class="back-link">
                    <i class='bx bx-arrow-back'></i> Regresar</a>
            </div>

            <div class="form-content">
                <form th:action="@{/guardarInv}" method="post" th:object="${inventario}">
                    <!-- Hidden field for usuario (automatically set by controller) -->
                    <input type="hidden" th:field="*{idUsuario.idUsuario}" />

                    <div class="form-group">
                        <label>Usuario Actual:</label>
                        <input type="text" th:value="${inventario.idUsuario.nombreUsuario} + ' ' + ${inventario.idUsuario.apellidoUsuario}"
                               readonly class="readonly-field">
                    </div>

                    <div class="form-group">
                        <label>Nombre Obra:</label>
                        <input type="text" name="nombreobra" th:field="*{nombreobra}" placeholder="Nombre de la obra">
                        <span class="error-message" th:if="${#fields.hasErrors('nombreobra')}" th:errors="*{nombreobra}">Campo obligatorio</span>
                    </div>

                    <!-- Fecha Ingreso -->
                    <div class="form-group">
                        <label>Fecha:</label>
                        <input type="date" name="fecha" th:field="*{fechaIngreso}">
                        <span class="error-message" th:if="${#fields.hasErrors('fechaIngreso')}" th:errors="*{fechaIngreso}">Campo obligatorio</span>
                    </div>

                    <!-- Cantidad Material -->
                    <div class="form-group">
                        <label>Cantidad:</label>
                                           </div>


                    <!-- Unidad Inventario -->
                    <div class="form-group">
                        <label>Unidad de Medida:</label>
                        <input type="text" name="unidadMedida" th:field="*{unidadInv}">
                        <span class="error-message" th:if="${#fields.hasErrors('unidadInv')}" th:errors="*{unidadInv}">Campo obligatorio</span>
                    </div>


                    <!-- Materiales Section - Multiple materials can be added -->
                    <div class="materials-section">
                        <h3><i class='bx bx-list-plus'></i> Materiales</h3>

                        <div class="material-items" id="materialItems">
                            <!-- Dynamic material items will be added here -->
                            <div class="material-item">
                                <div class="form-group">
                                    <label>Material:</label>
                                    <select name="materialIds" class="material-select">
                                        <option value="">-- Seleccionar Material --</option>
                                        <option th:each="material : ${materiales}"
                                                th:value="${material.idMaterial}"
                                                th:text="${material.especificaciones}"></option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Cantidad para este material:</label>

                                    <input type="number" name="cantidad" th:field="*{cantidadMat}" placeholder="Ingrese cantidad" min="0">
                                    <span class="error-message" th:if="${#fields.hasErrors('cantidadMat')}" th:errors="*{cantidadMat}">Campo obligatorio</span>


                                </div>
                                <button type="button" class="btn-remove-material" onclick="removeMaterial(this)">
                                    <i class='bx bx-trash'></i> Eliminar
                                </button>
                            </div>
                        </div>

                        <button type="button" class="btn-add-material" onclick="addMaterial()">
                            <i class='bx bx-plus'></i> Agregar otro material
                        </button>
                    </div>

                    <div class="submit-btn">
                        <input type="submit" name="salvar" value="Guardar">
                    </div>
                </form>
            </div>
        </div>
    </div>
</main>

<script>
    // JavaScript to handle dynamic material addition/removal
    function addMaterial() {
        const materialItems = document.getElementById('materialItems');
        const newMaterialItem = materialItems.firstElementChild.cloneNode(true);

        // Clear the values in the new item
        newMaterialItem.querySelector('.material-select').value = '';
        newMaterialItem.querySelector('.material-quantity').value = '';

        materialItems.appendChild(newMaterialItem);
    }

    function removeMaterial(button) {
        const materialItems = document.getElementById('materialItems');
        if (materialItems.children.length > 1) {
            const materialItem = button.closest('.material-item');
            materialItem.remove();
        }
    }
</script>

</body>
</html>